<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RouterSpace - Easy | kkso's Writeups</title><meta name=keywords content><meta name=description content="Tools Used  Nmap Virtualised Android Machine Burp Suite linpeas CVE-2021-3156 Proof of Concept script  User Enumeration Nmap scan report for 10.10.11.148 Host is up (0.063s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) 80/tcp open http |_http-title: RouterSpace | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-9802 | Content-Type: text/html; charset=utf-8 | Content-Length: 65 | ETag: W/&#34;41-HxO0Q/PimO73JhQv5GJkuRap/30&#34; | Date: Sun, 06 Mar 2022 05:33:50 GMT | Connection: close | Suspicious activity detected !"><meta name=author content><link rel=canonical href=https://kkso.github.io/writeups/routerspace/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kkso.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kkso.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kkso.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kkso.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kkso.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="RouterSpace - Easy"><meta property="og:description" content="Tools Used  Nmap Virtualised Android Machine Burp Suite linpeas CVE-2021-3156 Proof of Concept script  User Enumeration Nmap scan report for 10.10.11.148 Host is up (0.063s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) 80/tcp open http |_http-title: RouterSpace | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-9802 | Content-Type: text/html; charset=utf-8 | Content-Length: 65 | ETag: W/&#34;41-HxO0Q/PimO73JhQv5GJkuRap/30&#34; | Date: Sun, 06 Mar 2022 05:33:50 GMT | Connection: close | Suspicious activity detected !"><meta property="og:type" content="article"><meta property="og:url" content="https://kkso.github.io/writeups/routerspace/"><meta property="article:section" content="Writeups"><meta property="article:published_time" content="2022-03-06T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="RouterSpace - Easy"><meta name=twitter:description content="Tools Used  Nmap Virtualised Android Machine Burp Suite linpeas CVE-2021-3156 Proof of Concept script  User Enumeration Nmap scan report for 10.10.11.148 Host is up (0.063s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) 80/tcp open http |_http-title: RouterSpace | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-9802 | Content-Type: text/html; charset=utf-8 | Content-Length: 65 | ETag: W/&#34;41-HxO0Q/PimO73JhQv5GJkuRap/30&#34; | Date: Sun, 06 Mar 2022 05:33:50 GMT | Connection: close | Suspicious activity detected !"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://kkso.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"RouterSpace - Easy","item":"https://kkso.github.io/writeups/routerspace/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"RouterSpace - Easy","name":"RouterSpace - Easy","description":"Tools Used  Nmap Virtualised Android Machine Burp Suite linpeas CVE-2021-3156 Proof of Concept script  User Enumeration Nmap scan report for 10.10.11.148 Host is up (0.063s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) 80/tcp open http |_http-title: RouterSpace | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-9802 | Content-Type: text/html; charset=utf-8 | Content-Length: 65 | ETag: W/\u0026#34;41-HxO0Q/PimO73JhQv5GJkuRap/30\u0026#34; | Date: Sun, 06 Mar 2022 05:33:50 GMT | Connection: close | Suspicious activity detected !","keywords":[],"articleBody":"Tools Used  Nmap Virtualised Android Machine Burp Suite linpeas CVE-2021-3156 Proof of Concept script  User Enumeration Nmap scan report for 10.10.11.148 Host is up (0.063s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) 80/tcp open http |_http-title: RouterSpace | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-9802 | Content-Type: text/html; charset=utf-8 | Content-Length: 65 | ETag: W/\"41-HxO0Q/PimO73JhQv5GJkuRap/30\" | Date: Sun, 06 Mar 2022 05:33:50 GMT | Connection: close | Suspicious activity detected !!! {RequestID: USS C U m 72 } | GetRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-38102 | Accept-Ranges: bytes | Cache-Control: public, max-age=0 | Last-Modified: Mon, 22 Nov 2021 11:33:57 GMT | ETag: W/\"652c-17d476c9285\" | Content-Type: text/html; charset=UTF-8 | Content-Length: 25900 | Date: Sun, 06 Mar 2022 05:33:49 GMT | Connection: close | | |  | | | RouterSpace | | | | | | | | HTTPOptions: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-45749 | Allow: GET,HEAD,POST | Content-Type: text/html; charset=utf-8 | Content-Length: 13 | ETag: W/\"d-bMedpZYGrVt1nR4x+qdNZ2GqyRo\" | Date: Sun, 06 Mar 2022 05:33:49 GMT | Connection: close | GET,HEAD,POST | RTSPRequest, X11Probe: | HTTP/1.1 400 Bad Request |_ Connection: close |_http-favicon: Unknown favicon MD5: 63884385E642E4AAD06B21EBE2E2EE6C | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-trane-info: Problem with XML parsing of /evox/about Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 4.15 - 5.6 (92%) The initial Nmap scans shows 2 active services:\n 1 SSH service open on port 22 1 HTTP service open on port 80  Viewing the website shows the RouterSpace landing page, with the only option to download an apk. All other links lead to a page stating “Suspicious Activity” followed by a random code. Foothold Downloading the apk and running the app results in landing page with 1 button to check the status. Proxiying the traffic from android device to Burp Suite reveals a post request sent when interacting with the app.\nPOST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1 accept: application/json, text/plain, */* user-agent: RouterSpaceAgent Content-Type: application/json Content-Length: 16 Host: routerspace.htb Connection: close Accept-Encoding: gzip, deflate {\"ip\":\"0.0.0.0\"} With a response of:\nHTTP/1.1 200 OK X-Powered-By: RouterSpace X-Cdn: RouterSpace-6909 Content-Type: application/json; charset=utf-8 Content-Length: 11 ETag: W/\"b-ANdgA/PInoUrpfEatjy5cxfJOCY\" Date: Mon, 07 Mar 2022 06:46:35 GMT Connection: close \"0.0.0.0\\n\" Entering {\"ip\":\"~\"} in place of the ip however results in a return of “home/user/paul” which means that bash is being used to access which is returned as json. With this knowledge entering {\"ip\":\"0.0.0.0 | whoami \"} results in paul instead of just “whoami” being returned. This shows that commands are being executed by the machine therefore we can commit Remote Code Execution. By making a file in /user/paul/.ssh/authorized_keys and appending our public ssh key, we can then ssh into the machine as user.\nPrivilege Escalation Running linpeas.sh results in showing its sudo version is 1.8.31 which can be verified by typing sudoedit -s Y. The version can be verified as only 1.8.31 will result in system asking for a password. By using a CVE-2021-3156 Proof of Concept the user can be escalated to root.\n","wordCount":"560","inLanguage":"en","datePublished":"2022-03-06T00:00:00Z","dateModified":"2022-03-06T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://kkso.github.io/writeups/routerspace/"},"publisher":{"@type":"Organization","name":"kkso's Writeups","logo":{"@type":"ImageObject","url":"https://kkso.github.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://kkso.github.io/ accesskey=h title="kkso's Writeups (Alt + H)">kkso's Writeups</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://kkso.github.io/cvebreakdowns/ title="CVE Breakdowns"><span>CVE Breakdowns</span></a></li><li><a href=https://kkso.github.io/writeups/ title="HackTheBox Writeups"><span>HackTheBox Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>RouterSpace - Easy</h1><div class=post-meta><span title="2022-03-06 00:00:00 +0000 UTC">March 6, 2022</span>&nbsp;·&nbsp;3 min</div></header><div class=post-content><h3 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h3><ul><li>Nmap</li><li>Virtualised Android Machine</li><li>Burp Suite</li><li>linpeas</li><li>CVE-2021-3156 Proof of Concept script</li></ul><h1 id=user>User<a hidden class=anchor aria-hidden=true href=#user>#</a></h1><h3 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h3><pre tabindex=0><code>Nmap scan report for 10.10.11.148
Host is up (0.063s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     (protocol 2.0)
80/tcp open  http
|_http-title: RouterSpace
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.1 200 OK
|     X-Powered-By: RouterSpace
|     X-Cdn: RouterSpace-9802
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 65
|     ETag: W/&#34;41-HxO0Q/PimO73JhQv5GJkuRap/30&#34;
|     Date: Sun, 06 Mar 2022 05:33:50 GMT
|     Connection: close
|     Suspicious activity detected !!! {RequestID: USS C U m 72 }
|   GetRequest: 
|     HTTP/1.1 200 OK
|     X-Powered-By: RouterSpace
|     X-Cdn: RouterSpace-38102
|     Accept-Ranges: bytes
|     Cache-Control: public, max-age=0
|     Last-Modified: Mon, 22 Nov 2021 11:33:57 GMT
|     ETag: W/&#34;652c-17d476c9285&#34;
|     Content-Type: text/html; charset=UTF-8
|     Content-Length: 25900
|     Date: Sun, 06 Mar 2022 05:33:49 GMT
|     Connection: close
|     &lt;!doctype html&gt;
|     &lt;html class=&#34;no-js&#34; lang=&#34;zxx&#34;&gt;
|     &lt;head&gt;
|     &lt;meta charset=&#34;utf-8&#34;&gt;
|     &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt;
|     &lt;title&gt;RouterSpace&lt;/title&gt;
|     &lt;meta name=&#34;description&#34; content=&#34;&#34;&gt;
|     &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
|     &lt;link rel=&#34;stylesheet&#34; href=&#34;css/bootstrap.min.css&#34;&gt;
|     &lt;link rel=&#34;stylesheet&#34; href=&#34;css/owl.carousel.min.css&#34;&gt;
|     &lt;link rel=&#34;stylesheet&#34; href=&#34;css/magnific-popup.css&#34;&gt;
|     &lt;link rel=&#34;stylesheet&#34; href=&#34;css/font-awesome.min.css&#34;&gt;
|     &lt;link rel=&#34;stylesheet&#34; href=&#34;css/themify-icons.css&#34;&gt;
|   HTTPOptions: 
|     HTTP/1.1 200 OK
|     X-Powered-By: RouterSpace
|     X-Cdn: RouterSpace-45749
|     Allow: GET,HEAD,POST
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 13
|     ETag: W/&#34;d-bMedpZYGrVt1nR4x+qdNZ2GqyRo&#34;
|     Date: Sun, 06 Mar 2022 05:33:49 GMT
|     Connection: close
|     GET,HEAD,POST
|   RTSPRequest, X11Probe: 
|     HTTP/1.1 400 Bad Request
|_    Connection: close
|_http-favicon: Unknown favicon MD5: 63884385E642E4AAD06B21EBE2E2EE6C
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-trane-info: Problem with XML parsing of /evox/about

Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 4.15 - 5.6 (92%)
</code></pre><p>The initial Nmap scans shows 2 active services:</p><ul><li>1 SSH service open on port 22</li><li>1 HTTP service open on port 80</li></ul><p>Viewing the website shows the RouterSpace landing page, with the only option to download an apk. All other links lead to a page stating &ldquo;Suspicious Activity&rdquo; followed by a random code.
<img loading=lazy src=/img/RouterSpace/image1.png alt=image></p><h2 id=foothold>Foothold<a hidden class=anchor aria-hidden=true href=#foothold>#</a></h2><p>Downloading the apk and running the app results in landing page with 1 button to check the status. <img loading=lazy src=/img/RouterSpace/image2.png alt=image></p><p>Proxiying the traffic from android device to Burp Suite reveals a post request sent when interacting with the app.</p><pre tabindex=0><code>POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1
accept: application/json, text/plain, */*
user-agent: RouterSpaceAgent
Content-Type: application/json
Content-Length: 16
Host: routerspace.htb
Connection: close
Accept-Encoding: gzip, deflate

{&#34;ip&#34;:&#34;0.0.0.0&#34;}
</code></pre><p>With a response of:</p><pre tabindex=0><code>HTTP/1.1 200 OK
X-Powered-By: RouterSpace
X-Cdn: RouterSpace-6909
Content-Type: application/json; charset=utf-8
Content-Length: 11
ETag: W/&#34;b-ANdgA/PInoUrpfEatjy5cxfJOCY&#34;
Date: Mon, 07 Mar 2022 06:46:35 GMT
Connection: close

&#34;0.0.0.0\n&#34;
</code></pre><p>Entering <code>{"ip":"~"}</code> in place of the ip however results in a return of &ldquo;home/user/paul&rdquo; which means that bash is being used to access which is returned as json. With this knowledge entering <code>{"ip":"0.0.0.0 | whoami "}</code> results in paul instead of just &ldquo;whoami&rdquo; being returned. This shows that commands are being executed by the machine therefore we can commit Remote Code Execution. By making a file in /user/paul/.ssh/authorized_keys and appending our public ssh key, we can then ssh into the machine as user.</p><h1 id=privilege--escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege--escalation>#</a></h1><p>Running linpeas.sh results in showing its sudo version is 1.8.31 which can be verified by typing <code>sudoedit -s Y</code>. The version can be verified as only 1.8.31 will result in system asking for a password. By using a <a href=https://github.com/CptGibbon/CVE-2021-3156>CVE-2021-3156 Proof of Concept</a> the user can be escalated to root.</p></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://kkso.github.io/>kkso's Writeups</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>